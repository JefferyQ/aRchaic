devtools::install_github('jdblischak/workflowr')
x <- c("abc","123","Male")
regmatches(x,regexpr(".$", x))
x <- "data/moderns_lite/"
regmatches(x,regexpr(".$", x))
regmatches("data/moderns_lite/",regexpr(".$", "data/moderns_lite/"))
devtools::document()
library(aRchaic)
knitr::opts_chunk$set(echo = TRUE)
library(aRchaic)
modern_labs <- c(rep("GBR", 9), rep("FIN", 7), rep("CHS", 7), rep("PUR", 3), rep("CDX", 5), rep("PUR", 5),
rep("HGDP", 7), rep("MXL", 7))
folders <- c("data/moderns_lite/", "data/Lazaridis_2016/", "data/Lipson_2017/",
"data/Pinhasi_2014/",
"data/Skoglund/")
labs <- factor(c(modern_labs, rep("Lazaridis, 2016 (UDG)", 15), rep("Lipson, 2017 (UDG)", 15),
rep("Gamba, 2014 (non UDG)", 12), rep("Skoglund, 2005 (non UDG)", 9)),
levels = c("HGDP", "MXL", "PUR", "CDX", "CHS", "FIN", "GBR", "Lazaridis, 2016 (UDG)",
"Lipson, 2017 (UDG)", "Gamba, 2014 (non UDG)", "Skoglund, 2005 (non UDG)"))
levels <- levels(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 3, output_dir = "Figure2/main/")
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "Figure2/main/")
help("plot_archaic")
labs <- factor(c(modern_labs, rep("Lazaridis, 2016 (UDG)", 15), rep("Lipson, 2017 (UDG)", 15),
rep("Gamba, 2014 (non UDG)", 12), rep("Skoglund, 2005 (non UDG)", 9)),
levels = c("HGDP", "MXL", "PUR", "CDX", "CHS", "FIN", "GBR", "Lazaridis, 2016 (UDG)",
"Lipson, 2017 (UDG)", "Gamba, 2014 (non UDG)", "Skoglund, 2005 (non UDG)"))
model <- model_archaic(out, K = 3, output_dir = "Figure2/main/",
labs = labs)
modern_labs <- c(rep("GBR", 9), rep("FIN", 7), rep("CHS", 7), rep("PUR", 3), rep("CDX", 5), rep("PUR", 5),
rep("HGDP", 7), rep("MXL", 7))
labs <- factor(c(modern_labs, rep("Lazaridis, 2016 (UDG)", 15), rep("Lipson, 2017 (UDG)", 15),
rep("Gamba, 2014 (non UDG)", 12), rep("Skoglund, 2005 (non UDG)", 9)),
levels = c("HGDP", "MXL", "PUR", "CDX", "CHS", "FIN", "GBR", "Lazaridis, 2016 (UDG)",
"Lipson, 2017 (UDG)", "Gamba, 2014 (non UDG)", "Skoglund, 2005 (non UDG)"))
length(labs)
model <- model_archaic(out, K = 3, output_dir = "Figure2/main/",
labs = labs)
devtools::document()
library(aRchaic)
knitr::opts_chunk$set(echo = TRUE)
library(aRchaic)
model <- model_archaic(out, K = 3, output_dir = "Figure2/main/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "Figure2/main/")
model$labs
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "Figure2/main/")
labs <- model$labs
omega <- model$omega
annotation <- data.frame(
sample_id = paste0("X", c(1:NROW(omega))),
tissue_label = factor(labs, levels = levels)
)
dim(omega)
annotation
if(is.null(levels(labs))) levels <- unique(labs)
levels
levels(labs)
unique(labs)
source('~/Documents/aRchaic/R/plot_archaic.R')
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "Figure2/main/")
devtools::document()
library(aRchaic)
rm(list=ls())
library(aRchaic)
knitr::opts_chunk$set(echo = TRUE)
library(aRchaic)
modern_labs <- c(rep("GBR", 9), rep("FIN", 7), rep("CHS", 7), rep("PUR", 3), rep("CDX", 5), rep("PUR", 5),
rep("HGDP", 7), rep("MXL", 7))
folders <- c("data/moderns_lite/", "data/Lazaridis_2016/", "data/Lipson_2017/",
"data/Pinhasi_2014/",
"data/Skoglund/")
labs <- factor(c(modern_labs, rep("Lazaridis, 2016 (UDG)", 15), rep("Lipson, 2017 (UDG)", 15),
rep("Gamba, 2014 (non UDG)", 12), rep("Skoglund, 2005 (non UDG)", 9)),
levels = c("HGDP", "MXL", "PUR", "CDX", "CHS", "FIN", "GBR", "Lazaridis, 2016 (UDG)",
"Lipson, 2017 (UDG)", "Gamba, 2014 (non UDG)", "Skoglund, 2005 (non UDG)"))
#levels <- levels(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 3, output_dir = "Figure2/main/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "Figure2/main/")
devtools::document()
library(aRchaic)
knitr::opts_chunk$set(echo = TRUE)
library(aRchaic)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "Figure2/main/")
folders <- c("data/Lindo2016/")
N = "Nextara"
TS = "Tru-Seq"
labs <- c(rep("Ancient", 25), N, N, TS, N, TS, TS, N, TS, N, N, N, TS, N, N, N, N, N, N, N, N, N, N, TS, TS, TS)
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, output_dir = "Figure4/ancients_moderns/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 4),
output_dir = "Figure4/ancients_moderns/")
plot_archaic(model, topic_cols = c("red",  "blue"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 4),
output_dir = "Figure4/ancients_moderns/")
folders <- c("data/Lindo2016Moderns/")
labs <- c(N, N, TS, N, TS, TS, N, TS, N, N, N, TS, N, N, N, N, N, N, N, N, N, N, TS, TS, TS)
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "Figure4/moderns/",
labs = labs)
plot_archaic(model, topic_cols = c("hotpink","burlywood"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 5),
output_dir = "Figure4/moderns/")
folders <- c("data/Lindo2016Moderns/")
labs <- c(N, N, TS, N, TS, TS, N, TS, N, N, N, TS, N, N, N, N, N, N, N, N, N, N, TS, TS, TS)
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "Figure4/moderns/",
labs = labs)
plot_archaic(model, topic_cols = c("hotpink","burlywood"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 5),
output_dir = "Figure4/moderns/")
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "Figure4/moderns/",
labs = labs,
gom.control = list(init.adapt = TRUE))
plot_archaic(model, topic_cols = c("hotpink","burlywood"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 5),
output_dir = "Figure4/moderns/")
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "Figure4/moderns/",
labs = labs,
gom.control = list(init.adapt = TRUE))
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "Figure4/moderns/",
labs = labs,
gom.control = list(init.adapt = TRUE, sample_init = FALSE))
plot_archaic(model, topic_cols = c("hotpink","burlywood"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 5),
output_dir = "Figure4/moderns/")
folders <- c("data/Lindo2016Ancients/")
labs <- rep("Ancient", 25)
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "Figure4/ancients/",
labs = labs,
gom.control = list(init.adapt = TRUE, sample_init = FALSE))
plot_archaic(model, topic_cols = c("darkgoldenrod1", "cyan"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 5),
output_dir = "Figure4/ancients/")
modern_labs <- c(rep("GBR", 9), rep("FIN", 7), rep("CHS", 7), rep("PUR", 3), rep("CDX", 5), rep("PUR", 5),
rep("HGDP", 7), rep("MXL", 7))
folders <- c("data/moderns_lite/", "data/Lazaridis_2016/", "data/Lipson_2017/",
"data/Pinhasi_2014/",
"data/Skoglund/")
labs <- factor(c(modern_labs, rep("Lazaridis, 2016 (UDG)", 15), rep("Lipson, 2017 (UDG)", 15),
rep("Gamba, 2014 (non UDG)", 12), rep("Skoglund, 2005 (non UDG)", 9)),
levels = c("HGDP", "MXL", "PUR", "CDX", "CHS", "FIN", "GBR", "Lazaridis, 2016 (UDG)",
"Lipson, 2017 (UDG)", "Gamba, 2014 (non UDG)", "Skoglund, 2005 (non UDG)"))
levels <- levels(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 6, output_dir = "suppfig1/K6/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue", "cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "suppfig1/K6/")
folders <- c("data/Lindo2016/")
N = "Nextera"
TS = "Tru-Seq"
labs <- c(rep("Ancient", 25), N, N, TS, N, TS, TS, N, TS, N, N, N, TS, N, N, N, N, N, N, N, N, N, N, TS, TS, TS)
levels <- unique(labs)
out <- prepare_archaic(folders)
folders <- c("data/Lindo2016/")
N = "Nextera"
TS = "Tru-Seq"
labs <- c(rep("Ancient", 25), N, N, TS, N, TS, TS, N, TS, N, N, N, TS, N, N, N, N, N, N, N, N, N, N, TS, TS, TS)
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "Figure4/ancients_moderns/",
labs = labs)
plot_archaic(model, topic_cols = c("red",  "blue"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 4),
output_dir = "Figure4/ancients_moderns/")
folders <- c("data/Lindo2016/")
N = "Nextera"
TS = "Tru-Seq"
labs <- c(rep("Ancient", 25), N, N, TS, N, TS, TS, N, TS, N, N, N, TS, N, N, N, N, N, N, N, N, N, N, TS, TS, TS)
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 4, tol = 0.1, output_dir = "suppfig2/K4/",
labs = labs)
folders <- c("data/Lindo2016/")
N = "Nextera"
TS = "Tru-Seq"
labs <- c(rep("Ancient", 25), N, N, TS, N, TS, TS, N, TS, N, N, N, TS, N, N, N, N, N, N, N, N, N, N, TS, TS, TS)
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 4, tol = 0.1, output_dir = "suppfig3/K4/",
labs = labs)
plot_archaic(model, topic_cols = c("red",  "blue"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 4),
output_dir = "suppfig3/K4/")
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue", "cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 4),
output_dir = "suppfig3/K4/")
model <- model_archaic(out, K = 6, tol = 1, output_dir = "suppfig3/K6/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue", "cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue"), background = "modern",
logo.control = list(clip = 1, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
structure.control = list(structure_width = 4),
output_dir = "suppfig3/K6/")
modern_labs <- c(rep("GBR", 9), rep("FIN", 7), rep("CHS", 7), rep("PUR", 3), rep("CDX", 5), rep("PUR", 5),
rep("HGDP", 7), rep("MXL", 7))
folders <- c("data/moderns_lite/", "data/Lazaridis_2016/", "data/Lipson_2017/",
"data/Pinhasi_2014/",
"data/Skoglund/")
labs <- factor(c(modern_labs, rep("Lazaridis, 2016 (UDG)", 15), rep("Lipson, 2017 (UDG)", 15),
rep("Gamba, 2014 (non UDG)", 12), rep("Skoglund, 2005 (non UDG)", 9)),
levels = c("HGDP", "MXL", "PUR", "CDX", "CHS", "FIN", "GBR", "Lazaridis, 2016 (UDG)",
"Lipson, 2017 (UDG)", "Gamba, 2014 (non UDG)", "Skoglund, 2005 (non UDG)"))
levels <- levels(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 4, tol = 1, output_dir = "suppfig1/K6/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue", "cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "suppfig1/K4/")
modern_labs <- c(rep("GBR", 9), rep("FIN", 7), rep("CHS", 7), rep("PUR", 3), rep("CDX", 5), rep("PUR", 5),
rep("HGDP", 7), rep("MXL", 7))
folders <- c("data/moderns_lite/", "data/Lazaridis_2016/", "data/Lipson_2017/",
"data/Pinhasi_2014/",
"data/Skoglund/")
labs <- factor(c(modern_labs, rep("Lazaridis, 2016 (UDG)", 15), rep("Lipson, 2017 (UDG)", 15),
rep("Gamba, 2014 (non UDG)", 12), rep("Skoglund, 2005 (non UDG)", 9)),
levels = c("HGDP", "MXL", "PUR", "CDX", "CHS", "FIN", "GBR", "Lazaridis, 2016 (UDG)",
"Lipson, 2017 (UDG)", "Gamba, 2014 (non UDG)", "Skoglund, 2005 (non UDG)"))
levels <- levels(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 5, tol = 1, output_dir = "suppfig1/K5/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue", "cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "suppfig1/K5/")
model <- model_archaic(out, K = 4, tol = 1, output_dir = "suppfig1/K4/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue", "cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "suppfig1/K4/")
modern_labs <- c(rep("GBR", 9), rep("FIN", 7), rep("CHS", 7), rep("PUR", 3), rep("CDX", 5), rep("PUR", 5),
rep("HGDP", 7), rep("MXL", 7))
folders <- c("data/moderns_lite/", "data/Lazaridis_2016/", "data/Lipson_2017/",
"data/Pinhasi_2014/",
"data/Skoglund/")
labs <- factor(c(modern_labs, rep("Lazaridis, 2016 (UDG)", 15), rep("Lipson, 2017 (UDG)", 15),
rep("Gamba, 2014 (non UDG)", 12), rep("Skoglund, 2005 (non UDG)", 9)),
levels = c("HGDP", "MXL", "PUR", "CDX", "CHS", "FIN", "GBR", "Lazaridis, 2016 (UDG)",
"Lipson, 2017 (UDG)", "Gamba, 2014 (non UDG)", "Skoglund, 2005 (non UDG)"))
levels <- levels(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 4, tol = 1, output_dir = "suppfig1/K4/",
labs = labs)
plot_archaic(model, topic_cols = c("red", "darkgoldenrod1", "blue", "cyan","firebrick", "green",
"hotpink","burlywood","yellow","darkgray","deepskyblue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(2.5,1.5), output_width = 1300,
output_height = 700),
output_dir = "suppfig1/K4/")
setwd("~/Documents/ancient-damage/R")
library(aRchaic)
folders <- c("../data/KO_contam_all_reads/", "../data/moderns_lite_40/")
labs <- c(rep("KO, contam", 10), rep("moderns", 40))
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 1, output_dir = "../utilities/contam_moderns/",
labs = labs)
plot_archaic(model, topic_cols = c("red","blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
output_dir = "../utilities/contam_moderns/")
folders <- c("../data/KO_contam_all_reads_sub/", "../data/moderns_lite_40/")
labs <- c(rep("KO, contam", 10), rep("moderns", 40))
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 1, output_dir = "../utilities/contam_moderns_sub/",
labs = labs)
plot_archaic(model, topic_cols = c("red","blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
output_dir = "../utilities/contam_moderns_sub/")
folders <- c("../data/KO_contam_all_reads_sub/", "../data/moderns_lite_40/")
labs <- c(rep("KO, contam", 10), rep("moderns", 40))
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "../utilities/contam_moderns_sub/",
labs = labs)
plot_archaic(model, topic_cols = c("red","blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
output_dir = "../utilities/contam_moderns_sub/")
topic_clus <- get(load("../utilities/contam_moderns_sub/model.rda"))
contam_prop <- seq(0, 1, length.out = 10)
contam_prop[1] <- contam_prop[1] + 1e-5
contam_prop[10] <- contam_prop[10] - 1e-5
conc <- contam_prop
omega <- topic_clus$omega
omega2 <- omega[1:10,]
names <- paste0("S", 1:10)
at <- (seq(from = 0, to = 1, by = 0.1))
plot(conc, omega2[,1], xlab = "",
ylab = "", col = "red", pch = 20,
xaxt = "n", type = "o", cex = 3, lwd=3, cex.axis = 2, ylim = c(0, 1))
#plot(0.01*conc, omega2[,1], xlab = "",
#     ylab = "", col = "red", pch = 20,
#     xaxt = "n", type = "o", cex = 3, lwd=3, cex.axis = 2, ylim = c(0, 0.08))
axis(side = 1, at = at, cex.axis = 2)
text(conc, omega2[,1]+ 0.05, names, offset = 0.5, cex = 1.2, col = "black")
topic_clus <- get(load("../utilities/contam_moderns/model.rda"))
contam_prop <- seq(0, 1, length.out = 10)
contam_prop[1] <- contam_prop[1] + 1e-5
contam_prop[10] <- contam_prop[10] - 1e-5
conc <- contam_prop
omega <- topic_clus$omega
omega2 <- omega[1:10,]
names <- paste0("S", 1:10)
at <- (seq(from = 0, to = 1, by = 0.1))
plot(conc, omega2[,1], xlab = "",
ylab = "", col = "red", pch = 20,
xaxt = "n", type = "o", cex = 3, lwd=3, cex.axis = 2, ylim = c(0, 1))
#plot(0.01*conc, omega2[,1], xlab = "",
#     ylab = "", col = "red", pch = 20,
#     xaxt = "n", type = "o", cex = 3, lwd=3, cex.axis = 2, ylim = c(0, 0.08))
axis(side = 1, at = at, cex.axis = 2)
text(conc, omega2[,1]+ 0.05, names, offset = 0.5, cex = 1.2, col = "black")
folders <- c("data/KO_contam_all_reads/", "data/moderns_lite_40/")
labs <- c(rep("KO, contam", 10), rep("moderns", 40))
levels <- unique(labs)
out <- prepare_archaic(folders)
setwd("~/Dropbox/aRchaic")
folders <- c("data/KO_contam_all_reads/", "data/moderns_lite_40/")
labs <- c(rep("KO, contam", 10), rep("moderns", 40))
levels <- unique(labs)
out <- prepare_archaic(folders)
folders <- c("data/KO_contam_all_reads/", "data/moderns_lite_40/")
labs <- c(rep("KO, contam", 10), rep("moderns", 40))
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 1, output_dir = "Figure3/contam_moderns/",
labs = labs)
plot_archaic(model, topic_cols = c("red","blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
output_dir = "Figure3/contam_moderns/")
folders <- c("data/KO_contam_all_reads_sub/", "data/moderns_lite_40/")
labs <- c(rep("KO, contam", 10), rep("moderns", 40))
levels <- unique(labs)
out <- prepare_archaic(folders)
model <- model_archaic(out, K = 2, tol = 0.1, output_dir = "Figure3/contam_moderns/",
labs = labs)
plot_archaic(model, topic_cols = c("red","blue"), background = "modern",
logo.control = list(clip =0, mut_ranges = c(1, 2),
break_ranges = c(1,1), output_width = 1300,
output_height = 700),
output_dir = "Figure3/contam_moderns_sub/")
topic_clus <- get(load("Figure3/contam_moderns_sub/model.rda"))
devtools::document()
library(aRchaic)
